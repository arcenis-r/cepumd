<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Provides functions and data files to help CE PUMD users calculate 
    annual estimated expenditure means, standard errors, and quantiles according
    to the methods used by the CE using Public-Use Microdata (PUMD). For more
    information on the CE please visit &lt;https://www.bls.gov/cex&gt;. 
    For further reading on CE estimate calculations please see the CE 
    Calculation section of the BLS Handbook of Methods at 
    &lt;https://www.bls.gov/opub/hom/cex/calculation.htm&gt;. For further informaiton 
    about CE PUMD please visit &lt;https://www.bls.gov/cex/pumd.htm&gt;.">
<title>Calculate Consumer Expenditure Survey (CE) Annual Estimates • cepumd</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Calculate Consumer Expenditure Survey (CE) Annual Estimates">
<meta property="og:description" content="Provides functions and data files to help CE PUMD users calculate 
    annual estimated expenditure means, standard errors, and quantiles according
    to the methods used by the CE using Public-Use Microdata (PUMD). For more
    information on the CE please visit &lt;https://www.bls.gov/cex&gt;. 
    For further reading on CE estimate calculations please see the CE 
    Calculation section of the BLS Handbook of Methods at 
    &lt;https://www.bls.gov/opub/hom/cex/calculation.htm&gt;. For further informaiton 
    about CE PUMD please visit &lt;https://www.bls.gov/cex/pumd.htm&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">cepumd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/cepumd.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1></div>
<p>The purpose of <code>cepumd</code> is to make working with Consumer Expenditure Surveys (CE) Public-Use Microdata (PUMD) easier toward calculating mean, weighted, annual expenditures (henceforth “mean expenditures”). The challenges <code>cepumd</code> seeks to address deal primarily with pulling together the necessary data toward this end. Some of the overarching ideas underlying the package are as follows:</p>
<ul>
<li>Use a <a href="https://www.tidyverse.org/" class="external-link">Tidyverse</a> framework for most operations and be (hopefully) generally <a href="https://www.tidyverse.org/" class="external-link">Tidyverse</a> friendly</li>
<li>The best practice is to put all required data in one place, which <code>cepumd</code> does by default</li>
<li>Balance the effort to make the end user’s experience with CE PUMD easier while being flexible enough to allow that user to perform any analysis with the data they wish</li>
<li>Only designed to help users calculate mean <strong>expenditures</strong> on and of the consumer unit (CU), i.e., not income, not assets, not liabilities, not gifts, at least for now</li>
</ul>
<p>For a fuller description of <code>cepumd</code> and some sample workflows please visit <a href="https://arcenis-r.github.io/ajr-portfolio/cepumd.html" class="external-link uri">https://arcenis-r.github.io/ajr-portfolio/cepumd.html</a></p>
<p>And for more information on the CE, please visit <a href="https://www.bls.gov/cex/" class="external-link uri">https://www.bls.gov/cex/</a>.</p>
<div class="section level2">
<h2 id="challenges-addressed-by-cepumd">Challenges addressed by {cepumd}<a class="anchor" aria-label="anchor" href="#challenges-addressed-by-cepumd"></a>
</h2>
<p><code>cepumd</code> seeks to address challenges in three categories: data gathering/organization; managing data inconsistencies; and calculating weighted, annual metrics.</p>
<ul>
<li>
<strong>Data gathering/organization</strong>
<ul>
<li>Facilitate data and metadata downloads with <code><a href="reference/ce_download.html">ce_download()</a></code>, <code><a href="reference/store_ce_hg.html">store_ce_hg()</a></code>, and <code><a href="reference/store_ce_dict.html">store_ce_dict()</a></code>
</li>
<li>Convert hierarchical grouping (HG) files to data tables using <code><a href="reference/ce_hg.html">ce_hg()</a></code>
</li>
<li>Help the user identify the Universal Classification Codes (UCCs) related to their analysis using a combination of <code><a href="reference/ce_hg.html">ce_hg()</a></code> and <code><a href="reference/ce_uccs.html">ce_uccs()</a></code>
</li>
<li>Combine all required files and variables using <code><a href="reference/ce_prepdata.html">ce_prepdata()</a></code>
</li>
</ul>
</li>
<li>
<strong>Managing data inconsistencies</strong>
<ul>
<li>Provide the ability to recode variable categories using the CE Dictionary for Interview and Diary Surveys</li>
<li>Resolve some inconsistencies such as differences code definitions between the Interview and Diary (check the definitions of the “FAM_TYPE” variable categories in 2015 for an example)</li>
<li>Provide useful errors or warnings when there are multiple categories of something the user is trying to access, e.g., some titles in the hierarchical grouping files (“stub” or “HG” files) repeat and requires more careful selection of UCCs</li>
</ul>
</li>
<li>
<strong>Calculating weighted, annual metrics</strong>
<ul>
<li>Calculate a mean expenditure with <code><a href="reference/ce_mean.html">ce_mean()</a></code> or expenditure quantile with <code>ce_quantile()</code>
</li>
<li>Account for the factor (annual vs. quarterly expenditure)</li>
<li>Account for the “months in scope” of a given consumer unit (CU)</li>
<li>Annualize expenditures for either Diary or Interview expenditures</li>
<li>Integrate Interview and Diary data as necessary</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>cepumd</code> from <a href="https://github.com" class="external-link">GitHub</a>, but you’ll first need the <code>devtools</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"devtools"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span>, <span class="st">"Package"</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"arcenis-r/cepumd"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-cepumd-functions">Key cepumd functions<a class="anchor" aria-label="anchor" href="#key-cepumd-functions"></a>
</h2>
<ul>
<li><p>The workhorse of <code>cepumd</code> is <code><a href="reference/ce_prepdata.html">ce_prepdata()</a></code>. It merges the household characteristics file (FMLI/-D) with the corresponding expenditure tabulation file (MTBI/EXPD) for a specified year, adjusts weights for months-in-scope and the number of collection quarters, adjusts some cost values by their periodicity factor (some cost categories are represented as annual figures and others as quarterly). With the recent update it only requires the first 3 arguments to function: the year, the survey type, and one or more valid UCCs. <code><a href="reference/ce_prepdata.html">ce_prepdata()</a></code> now creates all of the other necessary objects within the function if not provided.</p></li>
<li>
<p>There are three functions for downloading the data and necessary documentation:</p>
<ul>
<li>
<code><a href="reference/ce_download.html">ce_download()</a></code> downloads zip files for a given year and survey instrument directly from the CE website</li>
<li>
<code><a href="reference/store_ce_hg.html">store_ce_hg()</a></code> downloads the zip file containing all HG files maintained by the CE to the specified location.</li>
<li>
<code><a href="reference/store_ce_dict.html">store_ce_dict()</a></code> downloades the CE PUMD dictionary from CE’s website to the specified location.</li>
</ul>
</li>
<li>
<p>There are two functions for wrangling hierarchical grouping data into more useable formats:</p>
<ul>
<li>
<code><a href="reference/ce_hg.html">ce_hg()</a></code> pulls the requested type of HG file (Interview, Diary, or Integrated) for a specified year.</li>
<li>
<code><a href="reference/ce_uccs.html">ce_uccs()</a></code> filters the HG file for the specified expenditure category and returns either a data frame with only that section of the HG file or the Universal Classification Codes (UCCs) that make up that expenditure category.</li>
</ul>
</li>
<li>
<p>There are two functions that the user can use to calculate CE summary statistics:</p>
<ul>
<li>
<code><a href="reference/ce_mean.html">ce_mean()</a></code> calculates a mean expenditure, standard error of the mean, coefficient of variation, and an aggregate expenditure.</li>
<li>
<code><a href="reference/ce_quantiles.html">ce_quantiles()</a></code> calculates weighted expenditure quantiles. It is important to note that calculating medians for integrated expenditures is not recommended because the calculation involves using weights from both the Diary and Survey instruments.</li>
</ul>
</li>
<li>
<p>There are two utility functions to make the workflow a bit easier:</p>
<ul>
<li>
<code><a href="reference/ce_pumd_years.html">ce_pumd_years()</a></code> scrapes the main PUMD website to get a vector of years for which PUMD are available. The vector is limited to the years for which there are also HG files available.</li>
<li>
<code><a href="reference/ce_cleanup.html">ce_cleanup()</a></code> deletes a file containing CE data that may only be necessary temporarily.</li>
</ul>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cepumd</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Arcenis Rojas <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Arcenis Rojas.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
